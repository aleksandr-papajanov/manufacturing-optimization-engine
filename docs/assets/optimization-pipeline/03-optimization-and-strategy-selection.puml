@startuml
!theme plain
autonumber

participant "Workflow Pipeline" as Pipeline
participant "OR-Tools Solver" as Solver
queue RabbitMQ as MQ
participant "API Gateway" as Gateway
database "Strategy Repository" as StrategyDB
participant UI
actor Customer

== Optimization ==

Pipeline -> Solver: Optimize proposals
Solver -> Solver: Linear Programming (SCIP)
Solver -> Pipeline: Return 4 strategies\n(LowestCost, Fastest, BestQuality, Green)

== Strategy Publication ==

Pipeline -> MQ: Publish MultipleStrategiesReadyEvent
MQ -> Gateway: Deliver event
Gateway -> StrategyDB: Store strategies

== Client Polling ==

loop Every 2â€“5 seconds
  UI -> Gateway: GET /api/optimization/strategies/{requestId}
  Gateway -> StrategyDB: Read strategies
  Gateway -> UI: Return strategies
end

Customer -> UI: Select strategy
UI -> Gateway: POST /api/optimization/select\n(strategyId)
Gateway -> MQ: Publish SelectStrategyCommand
MQ -> Pipeline: Deliver SelectStrategyCommand

@enduml