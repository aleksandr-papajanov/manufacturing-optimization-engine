@startuml
!theme plain
autonumber

participant "Workflow Pipeline" as Pipeline
queue RabbitMQ as MQ
participant "Provider Simulator 1" as P1
participant "Provider Simulator 2" as P2

== Matching Steps ==

Pipeline -> Pipeline: WorkflowMatchingStep\nIE4 â†’ Upgrade (8 steps)\nIE2 â†’ Refurbish (5 steps)
Pipeline -> Pipeline: ProviderMatchingStep\nFilter by capabilities\n& technical requirements

== Estimation (RPC) ==

loop For each provider & process
  Pipeline -> MQ: RPC ProposeProcessCommand\n(process.proposal.{providerId})
  MQ -> P1: Proposal request
  P1 -> P1: Evaluate cost & capacity
  P1 -> MQ: ProposalEstimatedEvent
  MQ -> Pipeline: Deliver estimate

  Pipeline -> MQ: RPC ProposeProcessCommand
  MQ -> P2: Proposal request
  P2 -> P2: Evaluate cost & capacity
  P2 -> MQ: ProposalEstimatedEvent
  MQ -> Pipeline: Deliver estimate
end

@enduml
